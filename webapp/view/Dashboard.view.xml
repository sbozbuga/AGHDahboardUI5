<mvc:View
	controllerName="ui5.aghd.controller.Dashboard"
	xmlns="sap.m"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns:f="sap.f"
	xmlns:card="sap.f.cards"
	displayBlock="true">

	<Page title="{i18n>appTitle}">
		<content>
			<GenericTile
				class="sapUiTinyMarginBegin sapUiTinyMarginTop"
				header="{i18n>totalQueries}"
				subheader="{i18n>last24Hours}"
				press="onPressLogs"
				tooltip="{i18n>viewQueryLog}">
				<TileContent>
					<NumericContent value="{/num_dns_queries}" icon="sap-icon://line-chart" />
				</TileContent>
			</GenericTile>

			<GenericTile
				class="sapUiTinyMarginBegin sapUiTinyMarginTop"
				header="{i18n>blockedQueries}"
				subheader="{i18n>last24Hours}"
				press="onPressBlockedLogs"
				tooltip="{i18n>viewBlockedQueryLog}">
				<TileContent>
					<NumericContent value="{/num_blocked_filtering}" icon="sap-icon://shield" valueColor="Error" />
				</TileContent>
			</GenericTile>

			<GenericTile
				class="sapUiTinyMarginBegin sapUiTinyMarginTop"
				header="{i18n>processingTime}"
				subheader="{i18n>average}"
				frameType="OneByOne"
				press="onPressLogs"
				tooltip="{i18n>viewQueryPerformanceLogs}">
				<TileContent>
					<NumericContent value="{/avg_processing_time}" scale="ms" icon="sap-icon://performance" valueColor="{path: '/avg_processing_time', formatter: '.formatter.formatElapsedColor'}" />
				</TileContent>
			</GenericTile>

			<GenericTile
				class="sapUiTinyMarginBegin sapUiTinyMarginTop"
				header="{i18n>blockedPercentage}"
				subheader="{i18n>efficiency}"
				frameType="OneByOne"
				press="onPressBlockedLogs"
				tooltip="{i18n>viewBlockedQueryLogs}">
				<TileContent>
					<NumericContent value="{/block_percentage}" scale="%" icon="sap-icon://pie-chart" valueColor="Critical" />
				</TileContent>
			</GenericTile>

            <f:GridContainer class="sapUiSmallMarginTop">
                <f:layout>
                    <f:GridContainerSettings rowSize="84px" columnSize="84px" gap="8px" />
                </f:layout>
                <f:layoutXS>
                    <f:GridContainerSettings rowSize="70px" columnSize="70px" gap="8px" />
                </f:layoutXS>
                
                <!-- Top Clients Card -->
                <f:Card class="hoverCopyCard">
                    <f:layoutData>
                        <f:GridContainerItemLayoutData columns="4" rows="6" />
                    </f:layoutData>
                    <f:header>
                        <card:Header title="{i18n>topClients}" iconSrc="sap-icon://group" />
                    </f:header>
                    <f:content>
                        <VBox height="100%" renderType="Bare">
                            <Button icon="sap-icon://copy" type="Transparent" press=".onCopyAllClients" tooltip="{parts:[{path:'i18n>copyAllClients'}, {path:'/top_clients', formatter: '.formatter.getLength'}], formatter: '.formatter.formatMessage'}" class="floatingCopyBtn" />
                            <Table items="{/top_clients}" inset="false" fixedLayout="true" class="sapUiSizeCompact" alternateRowColors="true" noDataText="{i18n>noActiveClients}">
                                <columns>
                                    <Column><Text text="{i18n>client}" /></Column>
                                <Column hAlign="End" width="30%"><Text text="{i18n>count}" /></Column>
                            </columns>
                            <items>
                                <ColumnListItem type="Navigation" press=".onPressClient" tooltip="{parts:[{path:'i18n>viewLogsFor'}, {path:'name'}], formatter: '.formatter.formatMessage'}">
                                    <cells>
                                        <HBox alignItems="Center" wrap="NoWrap" width="100%" justifyContent="SpaceBetween">
                                            <Text text="{name}" wrapping="false" class="sapUiTinyMarginEnd">
                                                <layoutData>
                                                    <FlexItemData growFactor="1" shrinkFactor="1" minWidth="0" />
                                                </layoutData>
                                            </Text>
                                            <Button icon="sap-icon://copy" type="Transparent" press=".onCopyClient" tooltip="{parts:[{path:'i18n>copyClientName'}, {path:'name'}], formatter: '.formatter.formatMessage'}" class="copyButton">
                                                <layoutData>
                                                    <FlexItemData shrinkFactor="0" />
                                                </layoutData>
                                            </Button>
                                        </HBox>
                                        <Text text="{path: 'count', formatter: '.formatter.formatNumber'}" />
                                    </cells>
                                </ColumnListItem>
                            </items>
                        </Table>
                        </VBox>
                    </f:content>
                </f:Card>

                <!-- Top Domains Card -->
                <f:Card class="hoverCopyCard">
                    <f:layoutData>
                        <f:GridContainerItemLayoutData columns="4" rows="6" />
                    </f:layoutData>
                    <f:header>
                        <card:Header title="{i18n>topDomains}" iconSrc="sap-icon://world" />
                    </f:header>
                     <f:content>
                        <VBox height="100%" renderType="Bare">
                            <Button icon="sap-icon://copy" type="Transparent" press=".onCopyAllDomains" tooltip="{parts:[{path:'i18n>copyAllDomains'}, {path:'/top_queried_domains', formatter: '.formatter.getLength'}], formatter: '.formatter.formatMessage'}" class="floatingCopyBtn" />
                            <Table items="{/top_queried_domains}" inset="false" fixedLayout="true" class="sapUiSizeCompact" alternateRowColors="true" noDataText="{i18n>noQueriesRecorded}">
                                <columns>
                                    <Column><Text text="{i18n>domain}" /></Column>
                                <Column hAlign="End" width="30%"><Text text="{i18n>count}" /></Column>
                            </columns>
                            <items>
                                <ColumnListItem type="Navigation" press=".onPressDomain" tooltip="{parts:[{path:'i18n>viewLogsFor'}, {path:'name'}], formatter: '.formatter.formatMessage'}">
                                    <cells>
                                        <HBox alignItems="Center" wrap="NoWrap" width="100%" justifyContent="SpaceBetween">
                                            <Text text="{name}" wrapping="false" class="sapUiTinyMarginEnd">
                                                <layoutData>
                                                    <FlexItemData growFactor="1" shrinkFactor="1" minWidth="0" />
                                                </layoutData>
                                            </Text>
                                            <Button icon="sap-icon://copy" type="Transparent" press=".onCopyDomain" tooltip="{parts:[{path:'i18n>copyDomainName'}, {path:'name'}], formatter: '.formatter.formatMessage'}" class="copyButton">
                                                <layoutData>
                                                    <FlexItemData shrinkFactor="0" />
                                                </layoutData>
                                            </Button>
                                        </HBox>
                                        <Text text="{path: 'count', formatter: '.formatter.formatNumber'}" />
                                    </cells>
                                </ColumnListItem>
                            </items>
                        </Table>
                        </VBox>
                    </f:content>
                </f:Card>

                <!-- Top Blocked Domains Card -->
                <f:Card class="hoverCopyCard">
                    <f:layoutData>
                        <f:GridContainerItemLayoutData columns="4" rows="6" />
                    </f:layoutData>
                    <f:header>
                        <card:Header title="{i18n>topBlockedDomains}" iconSrc="sap-icon://decline" />
                    </f:header>
                     <f:content>
                        <VBox height="100%" renderType="Bare">
                            <Button icon="sap-icon://copy" type="Transparent" press=".onCopyAllBlockedDomains" tooltip="{parts:[{path:'i18n>copyAllBlockedDomains'}, {path:'/top_blocked_domains', formatter: '.formatter.getLength'}], formatter: '.formatter.formatMessage'}" class="floatingCopyBtn" />
                            <Table items="{/top_blocked_domains}" inset="false" fixedLayout="true" class="sapUiSizeCompact" alternateRowColors="true" noDataText="{i18n>noBlockedDomains}">
                                <columns>
                                    <Column><Text text="{i18n>domain}" /></Column>
                                <Column hAlign="End" width="30%"><Text text="{i18n>count}" /></Column>
                            </columns>
                            <items>
                                <ColumnListItem type="Navigation" press=".onPressBlockedDomain" tooltip="{parts:[{path:'i18n>viewBlockedLogsFor'}, {path:'name'}], formatter: '.formatter.formatMessage'}">
                                    <cells>
                                        <HBox alignItems="Center" wrap="NoWrap" width="100%" justifyContent="SpaceBetween">
                                            <Text text="{name}" wrapping="false" class="sapUiTinyMarginEnd">
                                                <layoutData>
                                                    <FlexItemData growFactor="1" shrinkFactor="1" minWidth="0" />
                                                </layoutData>
                                            </Text>
                                            <Button icon="sap-icon://copy" type="Transparent" press=".onCopyDomain" tooltip="{parts:[{path:'i18n>copyDomainName'}, {path:'name'}], formatter: '.formatter.formatMessage'}" class="copyButton">
                                                <layoutData>
                                                    <FlexItemData shrinkFactor="0" />
                                                </layoutData>
                                            </Button>
                                        </HBox>
                                        <Text text="{path: 'count', formatter: '.formatter.formatNumber'}" />
                                    </cells>
                                </ColumnListItem>
                            </items>
                        </Table>
                        </VBox>
                    </f:content>
                </f:Card>

                <!-- Slowest Queries Card -->
                <f:Card class="hoverCopyCard">
                    <f:layoutData>
                        <f:GridContainerItemLayoutData columns="4" rows="6" />
                    </f:layoutData>
                    <f:header>
                        <card:Header title="{i18n>slowestQueries}" iconSrc="sap-icon://time-account" />
                    </f:header>
                     <f:content>
                        <VBox height="100%" renderType="Bare">
                            <Button icon="sap-icon://copy" type="Transparent" press=".onCopyAllSlowestQueries" tooltip="{parts:[{path:'i18n>copyAllSlowestQueries'}, {path:'/slowest_queries', formatter: '.formatter.getLength'}], formatter: '.formatter.formatMessage'}" class="floatingCopyBtn" />
                            <Table items="{/slowest_queries}" inset="false" fixedLayout="true" class="sapUiSizeCompact" alternateRowColors="true" noDataText="{i18n>noPerformanceData}">
                                <columns>
                                    <Column><Text text="{i18n>domain}" /></Column>
                                <Column hAlign="End" width="30%"><Text text="{i18n>elapsedMs}" /></Column>
                            </columns>
                            <items>
                                <ColumnListItem
                                    type="Navigation"
                                    press=".onPressSlowestDomain"
                                    tooltip="{
                                        path: 'occurrences',
                                        formatter: '.formatter.slowestTooltip'
                                    }">
                                    <cells>
                                        <HBox alignItems="Center" wrap="NoWrap" width="100%" justifyContent="SpaceBetween">
                                            <Text
                                                text="{
                                                    parts: [
                                                        {path: 'domain'},
                                                        {path: 'occurrences'}
                                                    ],
                                                    formatter: '.formatter.formatDomainWithCount'
                                                }"
                                                wrapping="false"
                                                class="sapUiTinyMarginEnd">
                                                <layoutData>
                                                    <FlexItemData growFactor="1" shrinkFactor="1" minWidth="0" />
                                                </layoutData>
                                            </Text>
                                            <Button icon="sap-icon://copy" type="Transparent" press=".onCopyDomain" tooltip="{parts:[{path:'i18n>copyDomainName'}, {path:'domain'}], formatter: '.formatter.formatMessage'}" class="copyButton">
                                                <layoutData>
                                                    <FlexItemData shrinkFactor="0" />
                                                </layoutData>
                                            </Button>
                                        </HBox>
                                        <ObjectNumber
											number="{
												path: 'elapsedMs',
												formatter: '.formatter.formatElapsed'
											}"
											state="{
												path: 'elapsedMs',
												formatter: '.formatter.formatElapsedState'
											}"
											tooltip="{
												path: 'elapsedMs',
												formatter: '.formatter.formatElapsedStateText'
											}"
                                             />
                                    </cells>
                                </ColumnListItem>
                            </items>
                        </Table>
                        </VBox>
                    </f:content>
                </f:Card>
            </f:GridContainer>
		</content>
		<footer>
			<OverflowToolbar>
				<Text text="{i18n>lastUpdated} {path: '/lastUpdated', type: 'sap.ui.model.type.DateTime', formatOptions: { style: 'medium' }}" visible="{= !!${/lastUpdated} }" class="sapUiTinyMarginBegin" />
				<Button icon="sap-icon://refresh" type="Transparent" press=".onManualRefresh" tooltip="{i18n>refreshData}" class="sapUiTinyMarginBegin" />
				<ToolbarSpacer />
				<Button text="{i18n>viewLogs}" press="onPressLogs" type="Emphasized" />
				<Button icon="sap-icon://action-settings" tooltip="{i18n>settings}" press="onOpenSettings" />
                <Button icon="sap-icon://log" tooltip="{i18n>logout}" press="onLogoutPress" />
			</OverflowToolbar>
		</footer>
	</Page>
</mvc:View>
